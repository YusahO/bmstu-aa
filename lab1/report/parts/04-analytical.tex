\chapter{Аналитическая часть}

\section{Расстояние Левенштейна}

Расстояние Левенштейна между двумя строками --- это минимальное количество операций вставки одного символа, удаления одного символа и замены одного символа на другой, необходимых для превращения строки в другую \cite{analysis-lev-damlev}.

Введем следующие обозначения операций:
\begin{itemize}
    \item $w(a, b)$ -- цена замены символа $a$ на символ $b$;
    \item $w(\varepsilon, b)$ – цена вставки символа $b$; 
    \item $w(a, \varepsilon)$ – цена удаления символа $a$; 
\end{itemize}

Каждая операция имеет определенную цену:
\begin{itemize}
    \item \textbf{M} (от англ. match): $w(a, a) = 0$
    \item \textbf{R} (от англ. replace): $w(a, b) = 1, a \ne b$
    \item \textbf{I} (от англ. insert): $w(\varepsilon, b) = 1$
    \item \textbf{D} (от англ. delete): $w(a, \varepsilon) = 1$
\end{itemize}

Пусть имеется две строки $S_1$ и $S_2$ длиной $m$ и $n$ соотвественно. Расстояние Левенштейна $d(S_1, S_2) = D(m, n)$ рассчитывается по следу\-ющей рекуррентной формуле \cite{prog-impl-lev}:

\begin{equation}
    \label{eqn:recur-lev}
    D(m, n) =
    \begin{cases}
        0, &\text{i = 0, j = 0}\\
        i, &\text{j = 0, i > 0}\\
        j, &\text{i = 0, j > 0}\\
        \min
        \begin{cases}
            D(i, j - 1) + 1,\\
            D(i - 1, j) + 1,\\
            D(i - 1, j - 1) + \text{m}(S_1[i], S_2[j]),
        \end{cases} &\text{j > 0, i > 0}
    \end{cases}
\end{equation}

\noindent где сравнение символов строк $S_1$ и $S_2$ производится следующим образом:

\begin{equation}
    \text{m}(a, b) = 
    \begin{cases}
        0, &\text{если $a = b$}\\
        1, &\text{иначе}
    \end{cases}
\end{equation}

\subsection{Нерекурсивный алгоритм нахождения рас\-стояния Левенштейна}
При больших значениях $m$ и $n$ рекурсивная реализация алгоритма поиска расстояния Левенштейна малоэффективна по времени выполнения, так как промежуточные значения $D(i, j)$ вычисляются несколько раз. В таком случае можно воспользоваться итеративной реализацией данного алгоритма, использующего матрицу для хранения промежуточных значений.

Матрица имеет размеры
\begin{equation}
(m + 1) \times (n + 1)
\end{equation}
\noindent где $m$ --- длина строки $S_1$, $n$ --- длина строки $S_2$.

В ячейке $[i, j]$ матрицы хранится значение $D(S_1[1..i], S_2[1..j])$. Пер\-вому элементу матрицы присвоено значение $0$. Вся матрица заполняется в соотвествии с соотношением (\ref{eqn:recur-lev}).

\section{Расстояние Дамерау-Левенштейна}

Расстояние Дамерау-Левенштейна является метрикой для измерения различий между двумя строками. Оно определяется как минимальное количество операций вставки, удаления, замены и транспозиции (перестановки двух соседних символов), необходимых для превращения одной строки в другую. Это расширение расстояния Левенштейна, так как, помимо трех базовых операций, оно также включает операцию транспозиции T (от англ. transposition).

Расстояние Дамерау-Левенштейна определяется по следующей рекуррентной формуле:

\begin{equation}
    \label{eqn:recur-damlev}
    D(m, n) = 
    \begin{cases}
        \max(i, j), &\min(i, j) = 0\\
        \min
        \begin{cases}
            D(i, j - 1) + 1,\\
            D(i - 1, j) + 1,\\
            D(i - 1, j - 1),\\
            D(i - 2, j - 2) + 1,
        \end{cases} 
        &\begin{aligned}
			& \text{если $i, j > 1$},\\
			& S_{1}[i] = S_{2}[j - 1],\\
			& S_{1}[i - 1] = S_{2}[j]\\
		\end{aligned}\\
        \min
        \begin{cases}
            D(i - 1, j) + 1,\\
            D(i, j - 1) + 1,\\
            D(i - 1, j - 1) + \text{m}(S_1[i], S_2[j])
        \end{cases} &\text{иначе.}
    \end{cases}
\end{equation}

\subsection{Рекурсивный алгоритм нахождения рассто\-яния Дамерау-Левенштейна}

Рекурсивный алгоритм поиска расстояния Дамерау-Левенштейна реализует формулу (\ref{eqn:recur-damlev}) следующим образом:

\begin{enumerate}
    \item Если одна из строк пустая, возвращается длина другой строки.
    \item Если последние символы двух строк совпадают,
    рекурсивно вызы\-вается функция для остатков строк
    (без последних символов).
    \item Иначе рекурсивно вызываются четыре варианта преобразования строки:
    \begin{itemize}
        \item \textbf{Вставка}: к результату рекурсивного вызова для остатка
        первой строки добавляется 1.
        \item \textbf{Удаление}: к результату рекурсивного вызова для остатка
        вто\-рой строки добавляется 1.
        \item \textbf{Замена}: к результату рекурсивного вызова для остатков строк
        добавляется 1.
        \item \textbf{Транспозиция}: если последние и
        предпоследние символы двух строк совпадают,
        к результату рекурсивного вызова для остатка строк
        добавляется 1.
    \end{itemize}
    \item Возвращается минимальное из четырех вариантов значение.
\end{enumerate}


\subsection{Рекурсивный алгоритм нахождения рассто\-яния Дамерау-Левенштейна с кэшировани\-ем}

При больших $m$ и $n$ рекурсивная реализация алгоритма поиска расстояния Дамерау-Левенштейна малоэффективна по времени, так как промежуточные значения расстояний между подстроками вычисляются неоднократно. Для оптимизации рекурсивного алгоритма по времени можно использовать матрицу в целях хранения соответствующих про\-межуточных значений. В таком случае алгоритм представляет собой рекурсивное заполнение матрицы $A_{m,n}$ промежуточными значениями $D(i, j)$.

\subsection{Нерекурсивный алгоритм нахождения рас\-стояния Дамерау-Левенштейна}

При больших значениях $m$, $n$ алгоритм нахождения расстояния Дамерау-Левенштейна, использующий рекурсию, не является эффективным по времени. Вместо рекурсивной реализации можно использовать итерационную реализацию. В таком случае в качестве структуры для хранения промежуточных значений $D(i, j)$ используется матрица, имеющая размеры 
\begin{equation}
    (m + 1) \times (n + 1)
\end{equation}

В ячейке $[i, j]$ матрицы хранится значение $D(S_1[1..i], S_2[1..j])$. Пер\-вому элементу матрицы присвоено значение $0$. Вся матрица заполняется в соотвествии с соотношением (\ref{eqn:recur-damlev}).

\section*{Вывод}
\addcontentsline{toc}{section}{Вывод}

В данном разделе были рассмотрены алгоритмы нахождения расстояний Левенштейна и Дамерау-Левенштейна --- их рекурсивные и итеративные реализации. Также была рассмотрена оптимизация алгоритма нахождения расстояния Дамерау-Левенштейна с помощью кэширования.